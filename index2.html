<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALM Learning Object Filter - Apple Style</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    display: flex;
    margin: 0;
    height: 100vh;
    background-color: #f5f5f7;
  }

  /* Filter Panel */
  #filterPanel {
    width: 280px;
    padding: 20px;
    border-right: 1px solid #ddd;
    background-color: #fff;
    overflow-y: auto;
  }

  #filterPanel h2 {
    font-size: 1.4em;
    margin-bottom: 10px;
  }

  .filter-group {
    margin-bottom: 20px;
  }

  .filter-group label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    font-size: 0.95em;
    color: #333;
  }

  .filter-group input {
    width: 100%;
    padding: 6px 8px;
    margin-bottom: 6px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 0.9em;
  }

  .filter-group select {
    width: 100%;
    border-radius: 6px;
    padding: 6px;
    font-size: 0.9em;
  }

  .badge-container {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
  }

  .badge {
    background-color: #0071e3;
    color: #fff;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.8em;
  }

  /* Results Panel */
  #resultsPanel {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
  }

  #resultsPanel h2 {
    font-size: 1.4em;
    margin-bottom: 15px;
  }

  .card {
    background-color: #fff;
    border-radius: 14px;
    padding: 16px;
    margin-bottom: 15px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  }

  .card h3 {
    margin-top: 0;
    margin-bottom: 8px;
    font-size: 1.1em;
    color: #111;
  }

  .card p {
    margin: 3px 0;
    font-size: 0.9em;
    color: #444;
  }

  .card p b {
    color: #000;
  }
</style>
</head>
<body>

<div id="filterPanel">
  <h2>Filters</h2>

  <div class="filter-group">
    <label for="catalogNames">Catalogs:</label>
    <input type="text" placeholder="Search catalog..." id="searchCatalog">
    <select id="catalogNames" multiple></select>
    <div class="badge-container" id="catalogBadges"></div>
  </div>

  <div class="filter-group">
    <label for="loType">Learning Object Type:</label>
    <select id="loType" multiple>
      <option value="course">Course</option>
      <option value="learningProgram">Learning Program</option>
      <option value="certification">Certification</option>
    </select>
    <div class="badge-container" id="typeBadges"></div>
  </div>

  <div class="filter-group">
    <label for="deliveryType">Delivery Type:</label>
    <input type="text" placeholder="Search delivery..." id="searchDelivery">
    <select id="deliveryType" multiple></select>
    <div class="badge-container" id="deliveryBadges"></div>
  </div>

  <div class="filter-group">
    <label for="loSkillLevels">Skill Levels:</label>
    <select id="loSkillLevels" multiple></select>
    <div class="badge-container" id="levelBadges"></div>
  </div>

  <div class="filter-group">
    <label for="loSkillNames">Skills:</label>
    <input type="text" placeholder="Search skills..." id="searchSkills">
    <select id="loSkillNames" multiple></select>
    <div class="badge-container" id="skillBadges"></div>
  </div>
</div>

<div id="resultsPanel">
  <h2>Search Results</h2>
  <div id="results">Select filters to see results...</div>
</div>

<script>
  const filterData = {
    catalogNames: ["AnupamCAT","Cat courses","eff LPs","Category B Learning objects","TESTY","CATALOG 101","CAT111 Vix","TESTStock","Harvard ManageMentor","WASA","Category A Learning objects","DELHI","Default Catalog","TEST","Anup2Raji","GET THE JOBS","RUSSIA","CAT_FOR_LP_TEST","Catalog Demo","TEST1"],
    deliveryType: ["Self Paced","Classroom","Blended","Activity","Virtual Classroom"],
    loSkillLevels: ["1","2","3"],
    loSkillNames: ["SKILL_three","Art","SKILL_one","LP SKILLS","Chemist","Pilot Vix","Migration Skill","Java Programming","After Effects**","LMS Basics","Mastering Illustrator","Lightroom","After Effects","After Effects*","Lightroom*","SKILL _two","CryptoGraphy","SKILL A","Onboarded","TEST1","Vector Illustrator","C.skill","Data analysis","skill Name1","Anupam's admin trial","Dpom","IT","skill Name2","skill Name3","Gamification","TEST SKILL C1","SKILL_105","SKILL_four","General","SKILL_103","Photoshop","SKILL_104","SKILL_101","SKILL_102"]
  };

  function populateSelect(id, options) {
    const select = document.getElementById(id);
    select.innerHTML = '';
    options.forEach(opt => {
      const option = document.createElement('option');
      option.value = opt;
      option.textContent = opt;
      select.appendChild(option);
    });
  }

  populateSelect('catalogNames', filterData.catalogNames);
  populateSelect('deliveryType', filterData.deliveryType);
  populateSelect('loSkillLevels', filterData.loSkillLevels);
  populateSelect('loSkillNames', filterData.loSkillNames);

  function getSelectedValues(id) {
    return Array.from(document.getElementById(id).selectedOptions).map(o => o.value);
  }

  function renderBadges(selectId, badgeContainerId) {
    const badges = getSelectedValues(selectId);
    const container = document.getElementById(badgeContainerId);
    container.innerHTML = '';
    badges.forEach(b => {
      const span = document.createElement('span');
      span.className = 'badge';
      span.textContent = b;
      container.appendChild(span);
    });
  }

  function renderResults(data) {
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = '';

    const items = data.results || [];
    if (!items.length) {
      resultsDiv.innerHTML = '<p>No results found for selected filters.</p>';
      return;
    }

    items.forEach(item => {
      const card = document.createElement('div');
      card.className = 'card';
      const catalogNames = (item.catalogInfo || []).map(c => c.name).join(', ');
      card.innerHTML = `
        <h3>${item.name || 'Untitled'}</h3>
        <p><b>Type:</b> ${item.loType || '-'}</p>
        <p><b>Delivery:</b> ${item.deliveryType || '-'}</p>
        <p><b>Catalog:</b> ${catalogNames}</p>
        <p><b>Authors:</b> ${(item.authors || []).join(', ')}</p>
        <p><b>Skills:</b> ${(item.loSkillNames || []).join(', ')}</p>
        <p><b>Skill Levels:</b> ${(item.loSkillLevels || []).join(', ')}</p>
        <p><b>Duration:</b> ${item.duration || 0} mins</p>
        <p><b>Status:</b> ${item.status || '-'}</p>
      `;
      resultsDiv.appendChild(card);
    });
  }

  async function fetchData() {
    const apiUrl = 'https://primeapps.adobe.com/almsearch/api/v1/production/108079/9b1e6b7f-20f3-4c49-a9c8-f5f4131096f8/search?size=50';
    const filters = {
      terms: {
        catalogNames: getSelectedValues('catalogNames'),
        loType: getSelectedValues('loType'),
        deliveryType: getSelectedValues('deliveryType'),
        loSkillLevels: getSelectedValues('loSkillLevels'),
        loSkillNames: getSelectedValues('loSkillNames')
      }
    };

    const body = { query: "", filters };
    try {
      const response = await fetch(apiUrl, {
        method: 'POST',
        headers: { 
          'Content-Type': 'application/json',
          'Origin': window.location.origin
        },
        body: JSON.stringify(body)
      });
      const data = await response.json();
      renderResults(data);
    } catch(err) {
      console.error('Error fetching data:', err);
      document.getElementById('results').innerHTML = '<p>Error fetching data</p>';
    }
  }

  // Event listeners
  ['catalogNames','loType','deliveryType','loSkillLevels','loSkillNames'].forEach(id => {
    document.getElementById(id).addEventListener('change', () => {
      renderBadges(id, id.replace('Names','Badges').replace('Type','TypeBadges').replace('Levels','LevelBadges'));
      fetchData();
    });
  });

  // Simple search inside select
  function addSearch(inputId, selectId) {
    const input = document.getElementById(inputId);
    const select = document.getElementById(selectId);
    input.addEventListener('input', () => {
      const filter = input.value.toLowerCase();
      Array.from(select.options).forEach(opt => {
        opt.style.display = opt.value.toLowerCase().includes(filter) ? '' : 'none';
      });
    });
  }

  addSearch('searchCatalog','catalogNames');
  addSearch('searchDelivery','deliveryType');
  addSearch('searchSkills','loSkillNames');
</script>

</body>
</html>
