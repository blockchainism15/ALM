<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ALM Embedded Player - Dynamic Config</title>
    <script src="https://cpcontents.adobe.com/public/publiccdn/playerInteractionLib.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
            background: #f5f5f7;
            color: #1c1c1e;
            padding: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0,0,0,0.1);
        }
        .input-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .input-row input {
            flex: 1;
            padding: 12px;
            font-size: 15px;
            border-radius: 12px;
            border: 1px solid #d1d1d6;
        }
        button {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: none;
            border-radius: 14px;
            background: black;
            color: white;
            cursor: pointer;
            margin-top: 10px;
            transition: opacity 0.2s;
        }
        button:hover { opacity: .8; }

        #playerContainer {
            width: 100%;
            margin-top: 30px;
            background: #000;
            border-radius: 16px;
            overflow: hidden;
            height: 500px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ALM Embedded Player – Configurable Demo</h1>

    <div class="container">
        <h2>Enter ALM Parameters</h2>

        <div class="input-row">
            <input id="userId" placeholder="userId (required)" />
            <input id="loId" placeholder="loId (required)" />
        </div>

        <div class="input-row">
            <input id="loInstanceId" placeholder="loInstanceId (required)" />
            <input id="actorId" placeholder="actorId (optional)" />
        </div>

        <div class="input-row">
            <input id="sessionToken" placeholder="sessionToken (required)" />
        </div>

        <button onclick="initializePlayer()">Initialize Player</button>

        <div id="playerContainer"></div>
    </div>

    <script>
        function initializePlayer() {
            const userId = document.getElementById("userId").value.trim();
            const loId = document.getElementById("loId").value.trim();
            const loInstanceId = document.getElementById("loInstanceId").value.trim();
            const sessionToken = document.getElementById("sessionToken").value.trim();
            const actorId = document.getElementById("actorId").value.trim();

            if (!userId || !loId || !loInstanceId || !sessionToken) {
                alert("Please fill all required fields: userId, loId, loInstanceId, sessionToken.");
                return;
            }

            const config = {
                loId,
                loInstanceId,
                userId,
                token: sessionToken,
                actorId: actorId || undefined,
                containerId: "playerContainer",
            };

            document.getElementById("playerContainer").style.display = "block";

            window.cpPlayerLib.initialize(config);
        }
    </script>
    <div class="container" style="margin-top:40px;">
        <h2>Player Event Logs</h2>
        <div id="logBox" style="background:#000; color:#0f0; padding:15px; height:250px; overflow-y:auto; border-radius:12px; font-family:monospace; font-size:14px;"></div>
    </div>

<script>
    function logEvent(msg) {
        const box = document.getElementById("logBox");
        const time = new Date().toLocaleTimeString();
        box.innerHTML += `[${time}] ${msg}<br>`;
        box.scrollTop = box.scrollHeight;
    }

    // Attach all cpPlayerLib callbacks
    function attachPlayerEventListeners() {
        if (!window.cpPlayerLib) return;

        cpPlayerLib.on("slide_enter", (e) => logEvent(`Slide Enter → slideId: ${e.slideId}`));
        cpPlayerLib.on("slide_exit", (e) => logEvent(`Slide Exit → slideId: ${e.slideId}`));
        cpPlayerLib.on("bookmark", (e) => logEvent(`Bookmark Set → ${JSON.stringify(e)}`));
        cpPlayerLib.on("suspend_data", (e) => logEvent(`Suspend Data Received`));
        cpPlayerLib.on("course_complete", (e) => logEvent(`Course Completed`));
        cpPlayerLib.on("error", (e) => logEvent(`Error: ${e.message}`));

        logEvent("Event listeners attached.");
    }

    const originalInit = initializePlayer;
    initializePlayer = function () {
        originalInit();
        attachPlayerEventListeners();
        logEvent("Player initialized.");
    }
</script>

</body>
</html>
